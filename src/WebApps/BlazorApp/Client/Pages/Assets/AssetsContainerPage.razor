@using BlazorApp.Client.DTO;

<div class="ts-container" style="@ContainerStyleTemplate">
    @{
        var curRow = 1;
        var curColumn = 1;

        foreach (var asset in _assets)
        {
            var itemStyle = string.Format(ItemStyleTemplate, curColumn, curColumn + 1, curRow, curRow + 1, RowHeight);

            <div class="ts-item" style="@itemStyle">
                <AssetPage />
            </div>

            curColumn++;
            if (curColumn > ColumnsAmount)
            {
                curColumn = 1;
                curRow++;
            }
        }
    }
    
</div>

@code{
    private readonly List<CryptoAssetPriceDTO> _assets = new List<CryptoAssetPriceDTO>();

    private int ColumnsAmount => 6;

    private int RowsAmount => (int)Math.Ceiling(_assets.Count / (decimal)ColumnsAmount);

    private int RowHeight => 150;

    private string ContainerStyleTemplate => $"--grid-template-columns:{string.Join(" ", Enumerable.Repeat("1fr", ColumnsAmount))};--grid-template-rows:{string.Join(" ", Enumerable.Repeat("1fr", RowsAmount))};";

    private string ItemStyleTemplate => "--grid-column-start:{0};--grid-column-end:{1};--grid-row-start:{2};--grid-row-end:{3};--height:{4}px";

    protected override void OnInitialized()
    {
        base.OnInitialized();

        for (var i = 0; i < 32; i++)
            _assets.Add(new CryptoAssetPriceDTO($"Asset {i}", "USDT", i));

    }
}